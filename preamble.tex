% Setup basic page geometry
\usepackage{geometry}

\geometry{
  a4paper,
  total={180mm, 257mm},
  left=15mm,
  top=20mm
}

% Set fonts
\usepackage{fontspec}

\setmainfont[Ligatures=TeX]{IBM Plex Sans}
\setsansfont[Ligatures=TeX]{IBM Plex Sans}

% Command to insert the cover page for each module
\newcommand{\coverpage}[4]{
  \begin{titlepage}
    \pagecolor{myPurple}
    \color{white}
    \vspace*{15mm}

    \noindent \huge{Hugh Baldwin}\\
    \large{up2157117}\\

    \vfill{}

    \noindent \huge{\textbf{#2}}\\
    \Large{#3}\\
    \Large{TB#4}\\

    \vfill{}

    { \linespread{1}
    \noindent \Large{University of Portsmouth}\\
    \Huge{BSc Computer Science}\\
    \Large{#1 Year}\\
    }

    \vspace*{15mm}
  \end{titlepage}
  \nopagecolor{}
}

% Set headers and footers, as well as PDF metadata
\usepackage{lastpage}
\usepackage{fancyhdr}
\usepackage{hyperref}

\renewcommand{\chaptermark}[1]{ \markboth{#1}{} }
\renewcommand{\sectionmark}[1]{ \markright{#1}{} }

% Module-Code Module-Name
\newcommand{\setupdocument}[2]{
  % Override the styling on a plain page
  \fancypagestyle{plain}{
    \renewcommand{\headrulewidth}{0pt}

    \fancyfoot[L]{Hugh Baldwin}
    \fancyfoot[C]{\textbf{\thepage} of \pageref*{LastPage}}
    \fancyfoot[R]{#1}

    \fancyhead[L]{\leftmark}
    \fancyhead[R]{}
  }

  \pagestyle{fancy}

  \renewcommand{\headrulewidth}{0pt}

  \fancyfoot[L]{Hugh Baldwin}
  \fancyfoot[C]{\textbf{\thepage} of \pageref*{LastPage}}
  \fancyfoot[R]{#1}

  \fancyhead[L]{\leftmark}
  \fancyhead[R]{}

  % Fancyhdr complains without changing the header height
  \setlength{\headheight}{14.5pt}
  \addtolength{\topmargin}{-2.5pt}

  \hypersetup{
    pdftitle={#1 - #2 (BSc Computer Science)},
    pdfauthor={Hugh Baldwin}
  }
}

% Set the format of chapter headers using titlesec
\usepackage{titlesec}

\titleformat{\chapter}[display]
  {\normalfont\bfseries}{}{0pt}{\Huge}

% Command to create a chapter for each type of session
% Title Time Date Lecturer Session-Type
\newcommand{\session}[5]{
  \chapter{#5 - #1}
  \vspace{-35pt}
  \large{#2}
  \hfill
  \large{#3}
  \hfill
  \large{#4}
}

\newcommand{\lecture}[4]{
  \session{#1}{#2}{#3}{#4}{Lecture}
}

\newcommand{\practical}[4]{
  \session{#1}{#2}{#3}{#4}{Practical Session}
}

% Use the xcolor package, and add my custom purple
\usepackage[dvipsnames]{xcolor}

\definecolor{myPurple}{RGB}{134, 53, 227}

% Setup hyperlink colours
\usepackage[]{hyperref}
\hypersetup{linkcolor=myPurple}